<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Terminal</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xterm@4.16.0/css/xterm.css">
</head>
<body>
  <div id="xterm-container" style="width: 100%; height: 100vh;"></div>

  <script src="https://cdn.jsdelivr.net/npm/xterm@4.16.0/lib/xterm.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xterm-addon-fit@0.4.0/lib/xterm-addon-fit.js"></script>
  <script>
    // 创建 WebSocket 连接到后端
    const ws = new WebSocket('ws://localhost:8080');
    
    // 初始化 xterm 实例
    const term = new Terminal();
    const fitAddon = new FitAddon.FitAddon();
    term.loadAddon(fitAddon);
    
    // 打开终端到 HTML 容器
    term.open(document.getElementById('xterm-container'));
    fitAddon.fit();  // 让终端自适应容器大小

    // WebSocket 接收数据并在 xterm 中展示
    ws.onmessage = function(event) {
      term.write(event.data);
    };

    // 用户输入通过 WebSocket 发送到后端
    term.onData(function(data) {
      ws.send(data);
    });

    // 处理 WebSocket 连接关闭
    ws.onclose = function() {
      term.write('\r\n[Connection closed]\r\n');
    };
  </script>
</body>
</html>
